{
  "hash": "5695f5b1afce4b21152c511cadcb605d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 7 Notes - Model Diagnostics and Spatial Autocorrelation\"\ndate: \"2025-10-20\"\n---\n\n## Key Concepts Learned\n\n### Regression Workflow\n\n**Building the model:**\n\n1.  Visualize relationships\n\n2.  Engineer features\n\n3.  Fit the model\n\n4.  Evaluate performance (RMSE, R²)\n\n5.  Check assumptions\n\n**Spatial Diagnostics**\n\n6.  Are errors random or clustered?\n7.  Do we predict better in some areas?\n8.  Is there remaining spatial structure?\n\n**Spatial Autocorrelation in Errors (i.e. Clustered Errors)**\n\n-   spatial pattern visible (not random scatter)\n\n-   under/over-predict in areas\n\n-   model misses something about location\n\n**Moran's I measures Spatial Autocorrelation**\n\n*Intuition: When I’m above/below average, are my neighbors also above/below average?*\n\n**Range:** -1 to +1\n\n-   **+1** = Perfect positive correlation (clustering)\n\n-   **0** = Random spatial pattern\n\n-   **-1** = Perfect negative correlation (dispersion)\n\n**Sample Example:**\n\n![](images/clipboard-2995180422.png){width=\"451\"}\n\nStep 1: Calculate Deviations from Mean\n\n![](images/clipboard-2249328638.png)\n\n**Positive deviation** = we over-predicted (actual \\> predicted)\\\n**Negative deviation** = we under-predicted (actual \\< predicted)\n\nStep 2: Multiply Neighbor Pair Deviations\n\n![](images/clipboard-645011366.png)\n\n-   Lots of positive products → **High Moran’s I** (clustering)\n\n-   Products near zero → **Low Moran’s I** (random)\n\n-   Negative products → **Negative Moran’s I** (rare with errors)\n\n## Coding Techniques\n\n-   **Create and Plot the Spatial Lag**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(spdep)\n\n# Define neighbors (5 nearest)\ncoords <- st_coordinates(boston_test)\nneighbors <- knn2nb(knearneigh(coords, k=5))\nweights <- nb2listw(neighbors, style=\"W\")\n\n# Calculate spatial lag of errors\nboston_test$error_lag <- lag.listw(weights, boston_test$error)\n```\n:::\n\n\n-   **Calculate Moran's I**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Test for spatial autocorrelation in errors\nmoran_test <- moran.mc(\n  boston_test$error,        # Your errors\n  weights,                  # Spatial weights matrix\n  nsim = 999                # Number of permutations\n)\n\n# View results\nmoran_test$statistic         # Moran's I value\n```\n:::\n\n\n## Questions & Challenges\n\n-   \n\n## Connections to Policy\n\n-   \n\n## Reflection\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}