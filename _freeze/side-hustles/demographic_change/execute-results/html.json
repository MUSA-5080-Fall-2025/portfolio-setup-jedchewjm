{
  "hash": "2ecb748e26c284b584a2a2e01609ab79",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Demographic Changes at Census Tract Level - Sharswood\"\nsubtitle: \"URBS 4000: Urban Studies Thesis\"\nauthor: \"Jed Chew\"\ndate: today\nformat: \n  html:\n    code-fold: false\n    toc: true\n    toc-location: left\n    theme: cosmo\n    embed-resources: true\nexecute:\n  warning: false\n  message: false\neditor: \n  markdown: \n    wrap: 80\n---\n\n## Project Title: Mixed by Design\n\n### *A Case Study of the Philadelphia Housing Authority's (PHA) Choice Neighborhoods Redevelopment of Sharswood*\n\nFor my Urban Studies thesis, I am researching the PHA's Choice Neighborhoods\nredevelopment of the Sharswood neighborhood in North Philadelphia. I have two\nmain research questions about the process and outcome of this redevelopment:\n\n\\(1\\) the **process** by which the PHA aligned the politics, finance, and design\nfor the redevelopment of Sharswood; andÂ \n\n\\(2\\) the early redevelopment **outcomes** relative to the Choice Neighborhoods\nInitiative (CNI) vision of mixed-partners, mixed-use, and mixed-income\n\n## Part 1: ACS Data\n\n**American Community Survey (ACS) Estimates**\n\n\\<insert information from\n\n### Step 1: Load Raw Data as csv files\n\n-   Philadelphia census tracts, block groups, and neighborhood boundaries\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load spatial data\ncensus_tracts <- tracts(state = \"PA\", county = \"Philadelphia\", year = 2020, class = \"sf\", cb = TRUE, progress = FALSE)\nblock_grps <- block_groups(state = \"PA\", county = \"Philadelphia\", year = 2020, class = \"sf\",cb = TRUE, progress = FALSE)\n\n# Standardize CRS\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n### Step 2: Get Philadelphia Demographic Data using `tidycensus`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load all available variables for ACS 5-year 2022\nacs_vars_2022 <- load_variables(2022, \"acs5\", cache = TRUE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Helper Variables for Summing Population Values for Children aged 5-19\nchild_pop = c(\"B01001_004\", \"B01001_005\", \"B01001_006\", \"B01001_007\", \n                \"B01001_028\", \"B01001_029\", \"B01001_030\", \"B01001_031\")\n\n\n# Helper Variable for Summing Population Values for Elderly Population\nelderly_pop = c(\"B01001_020\", \"B01001_021\", \"B01001_022\", \"B01001_023\", \n                \"B01001_024\", \"B01001_025\", \n                \"B01001_044\", \"B01001_045\", \"B01001_046\", \n                \"B01001_047\", \"B01001_048\", \"B01001_049\")\n\n# Get tract-level demographic data from 2022 ACS 5-Yr Estimates for Philadelphia\nphl_tract_2022_data <- get_acs(\n  geography = \"tract\",\n  variables = c(\n    total_pop = \"B01003_001\",\n    child_pop = child_pop,\n    elderly_pop = elderly_pop,\n    median_income = \"B19013_001\",\n    poverty = \"B17001_001\",\n    White     = \"B03002_003\",\n    Black     = \"B03002_004\",\n    Hispanic  = \"B03002_012\"\n  ),\n  state = \"PA\",\n  county = \"Philadelphia\",\n  year = 2022,\n  survey = \"acs5\",\n  output = \"wide\",\n  geometry = TRUE\n)\n\n# Clean the county names to remove state name and \"County\" \nphl_tract_2022_clean <- phl_tract_2022_data |> \n  separate(\n    NAME, \n    into = c(\"tract_name\", \"county_name\", \"state_name\"), \n    sep = \"; \"\n  ) |> \n  mutate(\n    tract_name = str_remove(tract_name, \"Census Tract \"),\n    county_name = str_remove(county_name, \" County\")\n  )\n\nphl_tract_2022_summary <- phl_tract_2022_clean |>\n  mutate(\n    elderly_popE = rowSums(across(matches(\"^elderly_pop\\\\d+E$\")), na.rm = TRUE),\n    # for MOE, ACS guidance is to combine by quadrature\n    elderly_popM = sqrt(rowSums(across(matches(\"^elderly_pop\\\\d+M$\"))^2, na.rm = \n                                  TRUE)),\n    pct_elderly = round((elderly_popE / total_popE) *100, 2),\n    child_popE = rowSums(across(matches(\"^child_pop\\\\d+E$\")), na.rm = TRUE),\n    child_popM = sqrt(rowSums(across(matches(\"^child_pop\\\\d+M$\"))^2, na.rm = \n                                  TRUE)),\n    pct_child = round((child_popE/total_popE) * 100, 2),\n  ) |>\n  select(GEOID, tract_name, county_name, total_popE, median_incomeE, elderly_popE, \n         elderly_popM, pct_elderly, child_popE, child_popM, pct_child)\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n### Step 3: Filter Data for Sharswood\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter Census Tracts for Sharswood\nsharswood_2022_tract_sf <- phl_tract_2022_summary |> \n  filter(tract_name %in% c(\"138\", \"139\"))\n\nggplot(sharswood_2022_tract_sf) +\n  geom_sf() +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](demographic_change_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsharswood_2022_tract <- sharswood_2022_tract_sf |> \n  st_drop_geometry()\nsharswood_2022_tract\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        GEOID tract_name  county_name total_popE median_incomeE elderly_popE\n1 42101013800        138 Philadelphia       2077          68864          126\n2 42101013900        139 Philadelphia       2585          41042          391\n  elderly_popM pct_elderly child_popE child_popM pct_child\n1     78.56208        6.07        255   127.1102     12.28\n2    142.44999       15.13        421   255.5876     16.29\n```\n\n\n:::\n:::\n\n\n--------------------------------------------------------------------------------\n\n### Step 4: Repeat Process for 2013-2017 ACS 5-Yr Estimates\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Helper Variables for Summing Population Values for Children aged 5-19\nchild_pop = c(\"B01001_004\", \"B01001_005\", \"B01001_006\", \"B01001_007\", \n                \"B01001_028\", \"B01001_029\", \"B01001_030\", \"B01001_031\")\n\n\n# Helper Variable for Summing Population Values for Elderly Population\nelderly_pop = c(\"B01001_020\", \"B01001_021\", \"B01001_022\", \"B01001_023\", \n                \"B01001_024\", \"B01001_025\", \n                \"B01001_044\", \"B01001_045\", \"B01001_046\", \n                \"B01001_047\", \"B01001_048\", \"B01001_049\")\n\n# Get tract-level demographic data from 2022 ACS 5-Yr Estimates for Philadelphia\nphl_2017_tract_data <- get_acs(\n  geography = \"tract\",\n  variables = c(\n    total_pop = \"B01003_001\",\n    child_pop = child_pop,\n    elderly_pop = elderly_pop,\n    median_income = \"B19013_001\",\n    poverty = \"B17001_001\",\n    White     = \"B03002_003\",\n    Black     = \"B03002_004\",\n    Hispanic  = \"B03002_012\"\n  ),\n  state = \"PA\",\n  county = \"Philadelphia\",\n  year = 2017,\n  survey = \"acs5\",\n  output = \"wide\",\n  geometry = TRUE\n)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clean the county names to remove state name and \"County\" \nphl_2017_tract_clean <- phl_2017_tract_data |> \n  separate(\n    NAME, \n    into = c(\"tract_name\", \"county_name\", \"state_name\"), \n    sep = \", \"\n  ) |> \n  mutate(\n    tract_name = str_remove(tract_name, \"Census Tract \"),\n    county_name = str_remove(county_name, \" County\")\n  )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nphl_2017_tract_summary <- phl_2017_tract_clean |>\n  mutate(\n    elderly_popE = rowSums(across(matches(\"^elderly_pop\\\\d+E$\")), na.rm = TRUE),\n    # for MOE, ACS guidance is to combine by quadrature\n    elderly_popM = sqrt(rowSums(across(matches(\"^elderly_pop\\\\d+M$\"))^2, na.rm = \n                                  TRUE)),\n    pct_elderly = round((elderly_popE / total_popE) *100, 2),\n    child_popE = rowSums(across(matches(\"^child_pop\\\\d+E$\")), na.rm = TRUE),\n    child_popM = sqrt(rowSums(across(matches(\"^child_pop\\\\d+M$\"))^2, na.rm = \n                                  TRUE)),\n    pct_child = round((child_popE/total_popE) * 100, 2),\n  ) |>\n  select(GEOID, tract_name, county_name, total_popE, median_incomeE, elderly_popE,\n         elderly_popM, pct_elderly, child_popE, child_popM, pct_child)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter Census Tracts for Sharswood\nsharswood_2017_tract_sf <- phl_2017_tract_summary |> \n  filter(tract_name == c(\"138\", \"139\"))\n\nggplot(sharswood_2017_tract_sf) +\n  geom_sf() +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](demographic_change_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsharswood_2017_tract <- sharswood_2017_tract_sf |> \n  st_drop_geometry()\nsharswood_2017_tract\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        GEOID tract_name  county_name total_popE median_incomeE elderly_popE\n1 42101013900        139 Philadelphia       2603          15028          449\n2 42101013800        138 Philadelphia       1840          27065          211\n  elderly_popM pct_elderly child_popE child_popM pct_child\n1    113.36225       17.25        435   179.5661     16.71\n2     61.48984       11.47        361   107.6336     19.62\n```\n\n\n:::\n:::\n\n\n### Step 5: Repeat Process for 2008-2012 ACS 5-Yr Estimates\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Helper Variables for Summing Population Values for Children aged 5-19\nchild_pop = c(\"B01001_004\", \"B01001_005\", \"B01001_006\", \"B01001_007\", \n                \"B01001_028\", \"B01001_029\", \"B01001_030\", \"B01001_031\")\n\n\n# Helper Variable for Summing Population Values for Elderly Population\nelderly_pop = c(\"B01001_020\", \"B01001_021\", \"B01001_022\", \"B01001_023\", \n                \"B01001_024\", \"B01001_025\", \n                \"B01001_044\", \"B01001_045\", \"B01001_046\", \n                \"B01001_047\", \"B01001_048\", \"B01001_049\")\n\n# Get tract-level demographic data from 2022 ACS 5-Yr Estimates for Philadelphia\nphl_2012_tract_data <- get_acs(\n  geography = \"tract\",\n  variables = c(\n    total_pop = \"B01003_001\",\n    child_pop = child_pop,\n    elderly_pop = elderly_pop,\n    median_income = \"B19013_001\",\n    poverty = \"B17001_001\",\n    White     = \"B03002_003\",\n    Black     = \"B03002_004\",\n    Hispanic  = \"B03002_012\"\n  ),\n  state = \"PA\",\n  county = \"Philadelphia\",\n  year = 2012,\n  survey = \"acs5\",\n  output = \"wide\",\n  geometry = TRUE\n)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clean the county names to remove state name and \"County\" \nphl_2012_tract_clean <- phl_2012_tract_data |> \n  separate(\n    NAME, \n    into = c(\"tract_name\", \"county_name\", \"state_name\"), \n    sep = \", \"\n  ) |> \n  mutate(\n    tract_name = str_remove(tract_name, \"Census Tract \"),\n    county_name = str_remove(county_name, \" County\")\n  )\n\nphl_2012_tract_summary <- phl_2012_tract_clean |>\n  mutate(\n    elderly_popE = rowSums(across(matches(\"^elderly_pop\\\\d+E$\")), na.rm = TRUE),\n    # for MOE, ACS guidance is to combine by quadrature\n    elderly_popM = sqrt(rowSums(across(matches(\"^elderly_pop\\\\d+M$\"))^2, na.rm = \n                                  TRUE)),\n    pct_elderly = round((elderly_popE / total_popE) *100, 2),\n    child_popE = rowSums(across(matches(\"^child_pop\\\\d+E$\")), na.rm = TRUE),\n    child_popM = sqrt(rowSums(across(matches(\"^child_pop\\\\d+M$\"))^2, na.rm = \n                                  TRUE)),\n    pct_child = round((child_popE/total_popE) * 100, 2),\n  ) |>\n  select(GEOID, tract_name, county_name, total_popE, median_incomeE, elderly_popE,\n         elderly_popM, pct_elderly, child_popE, child_popM, pct_child)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter Census Tracts for Sharswood\nsharswood_2012_tract_sf <- phl_2012_tract_summary |> \n  filter(tract_name %in% c(\"138\", \"139\"))\n\nggplot(sharswood_2012_tract_sf) +\n  geom_sf() +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](demographic_change_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsharswood_2012_tract <- sharswood_2012_tract_sf |> \n  st_drop_geometry()\nsharswood_2012_tract\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        GEOID tract_name  county_name total_popE median_incomeE elderly_popE\n1 42101013800        138 Philadelphia       2026          26500          243\n2 42101013900        139 Philadelphia       3323          15542          419\n  elderly_popM pct_elderly child_popE child_popM pct_child\n1     98.40732       11.99        482   206.3032     23.79\n2    147.05441       12.61        828   213.2815     24.92\n```\n\n\n:::\n:::\n\n\n--------------------------------------------------------------------------------\n\n## Part 2: Comprehensive Visualization and Analysis\n\n--------------------------------------------------------------------------------\n",
    "supporting": [
      "demographic_change_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}