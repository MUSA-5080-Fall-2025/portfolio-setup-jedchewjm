{
  "hash": "950e194132f53624c8ee635a93cc6078",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Vacancy, Land Use, and Businesses - Sharswood\"\nsubtitle: \"URBS 4000: Urban Studies Thesis\"\nauthor: \"Jed Chew\"\ndate: today\nformat: \n  html:\n    code-fold: false\n    toc: true\n    toc-location: left\n    theme: cosmo\n    embed-resources: true\nexecute:\n  warning: false\n  message: false\neditor: \n  markdown: \n    wrap: 80\n---\n\n## Project Title: Mixed by Design\n\n### *A Case Study of the Philadelphia Housing Authority's (PHA) Choice Neighborhoods Redevelopment of Sharswood*\n\nFor my Urban Studies thesis, I am researching the PHA's Choice Neighborhoods\nredevelopment of the Sharswood neighborhood in North Philadelphia. I have two\nmain research questions about the process and outcome of this redevelopment:\n\n\\(1\\) the **process** by which the PHA aligned the politics, finance, and design\nfor the redevelopment of Sharswood; and \n\n\\(2\\) the early redevelopment **outcomes** relative to the Choice Neighborhoods\nInitiative (CNI) vision of mixed-partners, mixed-use, and mixed-income\n\n## Part 1: Vacancy Data\n\n**Vacant Property Indicators from Open Data Philly**\n\n-   Data Source:\n    <https://opendataphilly.org/datasets/vacant-property-indicators/>\n\n-   Date Downloaded: Oct 20, 2025\n\n-   Description: The location of properties across Philadelphia that are likely\n    to be a vacant lot or vacant building based on an assessment of City of\n    Philadelphia administrative datasets.\n\n-   Types of GeoJSON Files: Buildings, Land, and Points\n\n### Step 1: Load Raw Data as csv files\n\n-   Philadelphia census tracts, block groups, and neighborhood boundaries\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(tidyverse)\nlibrary(tidycensus)\nlibrary(janitor)\nlibrary(sf)\nlibrary(tigris)\nlibrary(scales)\nlibrary(ggnewscale)\nlibrary(patchwork)\nlibrary(RColorBrewer)\nlibrary(viridisLite)\nlibrary(units)\nlibrary(knitr)\nlibrary(caret)\n```\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load spatial data\ncensus_tracts <- tracts(state = \"PA\", county = \"Philadelphia\", year = 2020, class = \"sf\", cb = TRUE, progress = FALSE)\nblock_grps <- block_groups(state = \"PA\", county = \"Philadelphia\", year = 2020, class = \"sf\",cb = TRUE, progress = FALSE)\n\n# Filter Block Groups for Sharswood\nids <- c(\"421010138001\",\"421010138002\",\"421010139001\",\n         \"421010139002\",\"421010139003\")\n\nsharswood_bg_sf <- block_grps |>\n filter(GEOID %in% ids) |> \n  st_transform(2272) # PA State Plane (in US Survey Feet)\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n### Step 2: Get Philadelphia Demographic Data using `tidycensus`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load all available variables for ACS 5-year 2022\nacs_vars_2022 <- load_variables(2022, \"acs5\", cache = TRUE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get tract-level demographic data from 2022 ACS 5-Yr Estimates for Philadelphia\nphl_tract_2022_data <- get_acs(\n  geography = \"tract\",\n  variables = c(\n    total_pop = \"B01003_001\",\n    median_income = \"B19013_001\",\n    poverty = \"B17001_001\",\n    White     = \"B03002_003\",\n    Black     = \"B03002_004\",\n    Hispanic  = \"B03002_012\"\n  ),\n  state = \"PA\",\n  county = \"Philadelphia\",\n  year = 2022,\n  survey = \"acs5\",\n  output = \"wide\",\n  geometry = TRUE\n)\n\n# Clean the county names to remove state name and \"County\" \nphl_tract_2022_clean <- phl_tract_2022_data |> \n  separate(\n    NAME, \n    into = c(\"tract_name\", \"county_name\", \"state_name\"), \n    sep = \"; \"\n  ) |> \n  mutate(\n    tract_name = str_remove(tract_name, \"Census Tract \"),\n    county_name = str_remove(county_name, \" County\")\n  )\n\nphl_tract_2022_summary <- phl_tract_2022_clean |>\n  select(GEOID, tract_name, county_name, total_popE, median_incomeE)\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n### Step 3: Filter Data for Sharswood\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter Census Tracts for Sharswood\nsharswood_2022_tract_sf <- phl_tract_2022_summary |> \n  filter(tract_name %in% c(\"138\", \"139\"))\n\nsharswood_2022_tract <- sharswood_2022_tract_sf |> \n  st_drop_geometry()\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Spatially Filter Vacancy Data for Sharswood\nvacant_bldgs <- st_read(\"data/Vacant_Indicators_Bldg.geojson\")\nvacant_land <- st_read(\"data/Vacant_Indicators_Land.geojson\")\nvacant_pts <- st_read(\"data/Vacant_Indicators_Points.geojson\")\nsharswood_land_parcels <- st_read(\"data/sharswood_parcels.geojson\")\n\nsharswood_zip <- 19121\n\nsharswood_vacant_bldgs <- vacant_bldgs |> \n  st_transform(st_crs(sharswood_bg_sf)) |> \n  filter(zipcode == sharswood_zip) |> \n  mutate(bldg_desc = str_squish(bldg_desc)) |>\n  filter(\n    !is.na(bldg_desc), # filter out NAs\n    !str_detect(bldg_desc, regex(\"\\\\bschool\\\\b\", ignore_case = TRUE)), # filter out Girard College\n    !str_detect(bldg_desc, regex(\"\\\\bland\\\\b\", ignore_case = TRUE)) # filter out Land\n  ) |> \n  mutate(\n    # Remove \"MASONRY\" and tidy up\n    bldg_desc_clean = str_squish(str_remove(bldg_desc, \n                                            regex(\"MASONRY\", ignore_case = TRUE))),\n    # Create broader categories\n    bldg_type = case_when(\n      str_detect(bldg_desc_clean, \n                 regex(\"APT\\\\s*2-4\", ignore_case = TRUE)) ~ \"Apt 2-4 units\",\n      str_detect(bldg_desc_clean, \n                 regex(\"ROW\\\\s*\\\\d\", ignore_case = TRUE)) ~ \"Rowhouse\",\n      str_detect(bldg_desc_clean, \n                 regex(\"ROW\\\\s*CONV\", ignore_case = TRUE)) ~ \"Rowhouse Convert/Apt\",\n      str_detect(bldg_desc_clean, \n                 regex(\"SEMI\", ignore_case = TRUE)) ~ \"Semi-Detached\",\n      str_detect(bldg_desc_clean, \n                 regex(\"STORE\", ignore_case = TRUE)) ~ \"Store\",\n      str_detect(bldg_desc_clean, \n                 regex(\"STR/OFF\\\\+APTS\", ignore_case = TRUE)) ~ \"Store/Office + Apts\",\n      str_detect(bldg_desc_clean, \n                 regex(\"HSE\\\\s+WORSHIP\", ignore_case = TRUE)) ~ \"Hse of Worship\",\n      TRUE ~ \"Other\")\n  ) |>\n  st_filter(sharswood_bg_sf, .predicate = st_intersects)\n\nsharswood_vacant_land <- vacant_land |> \n  st_transform(st_crs(sharswood_bg_sf)) |> \n  filter(ZIPCODE == sharswood_zip,\n         BLDG_DESC == \"VAC LAND RES < ACRE\") |> \n  st_filter(sharswood_bg_sf, .predicate = st_intersects)\n\nsharswood_vacant_pts <- vacant_pts |> \n  st_transform(st_crs(sharswood_bg_sf)) |> \n  filter(ZIPCODE == sharswood_zip) |> \n  st_filter(sharswood_bg_sf, .predicate = st_within)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vacancy in Table Format\nsharswood_vacant_bldgs_df <- sharswood_vacant_bldgs |> \n  st_drop_geometry() |> \n  select(objectid, address, owner1, bldg_desc, bldg_type, zoningbasedistrict)\n\nsharswood_vacant_land_df <- sharswood_vacant_land |> \n  st_drop_geometry() |> \n  select(OBJECTID, ADDRESS, OWNER1, BLDG_DESC, ZONINGBASEDISTRICT)\n\nsharswood_vacant_pts_df <- sharswood_vacant_pts |> \n  st_drop_geometry() |> \n  select(OBJECTID, ADDRESS, OWNER1, BLDG_DESC, ZONINGBASEDISTRICT)\n```\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Count Vacant Land by Owner\nsharswood_vacant_land_owner <- sharswood_vacant_land |> \n  mutate(owner_std = str_to_title(str_squish(OWNER1))) |> \n  add_count(owner_std, name = \"owner_n\")  |> \n  mutate(\n    owner_grp = case_when(\n      is.na(owner_std) | owner_std == \"\" ~ \"Unknown\",\n      owner_n == 1                       ~ \"Individual Owners\",\n      TRUE                               ~ owner_std\n    )\n  ) |> \n  select(-owner_n)\n\nsharswood_vacant_land_owner_df <- sharswood_vacant_land_owner |> \n  st_drop_geometry() |> \n  select(OBJECTID, ADDRESS, OWNER1, BLDG_DESC, owner_grp, ZONINGBASEDISTRICT)\n```\n:::\n\n\n--------------------------------------------------------------------------------\n\n### Step 4: Plot Maps of Vacant Buildings, Land, and Points in Sharswood\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Build palettes that expand to any number of categories\nn_bldg <- dplyr::n_distinct(sharswood_vacant_bldgs$bldg_type)\n# Blue → teal → green\nbldg_cols <- colorRampPalette(\n  c(\"#084081\", \"#2b8cbe\", \"#4eb3d3\", \"#7bccc4\", \"#43a2ca\", \"#2ca25f\", \"#238b45\", \"#006d2c\")\n)(n_bldg)\n\nn_land <- dplyr::n_distinct(sharswood_vacant_land$ZONINGBASEDISTRICT)\nland_cols <- colorRampPalette(brewer.pal(3, \"Reds\"))(n_land)\n\nggplot() +\n  geom_sf(data = sharswood_land_parcels, fill = NA, color = \"gray60\", linewidth = 0.4) +\n  geom_sf(data = sharswood_vacant_bldgs, \n          aes(fill = bldg_type), \n          color = \"grey10\", linewidth = 0.08) +\n  scale_fill_manual(values = bldg_cols, name = \"Vacant Buildings - Type\") +\n  guides(fill = guide_legend(order = 1)) +\n  new_scale_fill() +\n  geom_sf(data = sharswood_vacant_land,\n          aes(fill = ZONINGBASEDISTRICT),\n          color = \"grey30\", linewidth = 0.2, alpha = 0.65) +\n  scale_fill_manual(values = land_cols, name = \"Vacant Land - Zoning\") +\n  guides(fill = guide_legend(order = 2)) +\n  labs(\n    title = \"Vacant Land and Buildings in Sharswood\",\n    caption = \"Vacant Land updated 3/24/25; Vacant Buildings updated 7/7/25\",\n  ) +\n  theme_void() +\n  theme(\n    legend.position = \"right\",\n    legend.title = element_text(size = 11, face = \"bold\"),\n    legend.text  = element_text(size = 9),\n    plot.title   = element_text(face = \"bold\"),\n    plot.caption = element_text(hjust = 0, size = 9, margin = margin(t = 6))\n  )\n```\n\n::: {.cell-output-display}\n![](vacancy_land_use_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vacant Land by Ownership\nn_land_owner <- dplyr::n_distinct(sharswood_vacant_land_owner$owner_grp)\nland_owner_cols <- colorRampPalette(brewer.pal(8, \"Set1\"))(n_land_owner)\n\nggplot() +\n  geom_sf(data = sharswood_land_parcels, fill = NA, color = \"gray60\", linewidth = 0.4) +\n  geom_sf(data = sharswood_vacant_land_owner,\n          aes(fill = owner_grp),\n          color = \"grey30\", linewidth = 0.2, alpha = 0.65) +\n  scale_fill_manual(values = land_owner_cols, name = \"Vacant Land - Ownership\") +\n  guides(fill = guide_legend(order = 2)) +\n  labs(\n    title = \"Vacant Land in Sharswood by Ownership\",\n    caption = \"Vacant Land updated 3/24/25\"\n  ) +\n  theme_void() +\n  theme(\n    legend.position = \"right\",\n    legend.title = element_text(size = 11, face = \"bold\"),\n    legend.text  = element_text(size = 9),\n    plot.title   = element_text(face = \"bold\"),\n    plot.caption = element_text(hjust = 0, size = 9, margin = margin(t = 6))\n  )\n```\n\n::: {.cell-output-display}\n![](vacancy_land_use_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = sharswood_land_parcels, fill = NA, color = \"gray50\", linewidth = 0.6) +\n  geom_sf(data = sharswood_vacant_bldgs, aes(fill = bldg_desc)) +\n  labs(\n    title = \"Vacant Buildings in Sharswood\",\n    subtitle = \"Date Last Updated: July 7, 2025\") +\n  theme_void()\n\nggplot() +\n  geom_sf(data = sharswood_land_parcels, fill = NA, color = \"gray50\", linewidth = 0.6) +\n  geom_sf(data = sharswood_vacant_land, aes(fill = ZONINGBASEDISTRICT)) +\n  labs(\n    title = \"Vacant Land in Sharswood\",\n    subtitle = \"Date Last Updated: March 24, 2025\") +\n  theme_void()\n\nggplot() +\n  geom_sf(data = sharswood_land_parcels, fill = NA, color = \"gray50\", linewidth = 0.6) +\n  geom_sf(data = sharswood_vacant_pts, aes(color = VACANT_FLAG)) +\n  labs(\n    title = \"Vacant Points in Sharswood\",\n    subtitle = \"Date Last Updated: March 24, 2025\") +\n  theme_void()\n```\n:::\n\n",
    "supporting": [
      "vacancy_land_use_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}